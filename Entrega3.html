<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.475">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Ángel García, Arnau Piferrer y Guillem Serra">

<title>Entrega3</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
</style>


<script src="Entrega3_files/libs/clipboard/clipboard.min.js"></script>
<script src="Entrega3_files/libs/quarto-html/quarto.js"></script>
<script src="Entrega3_files/libs/quarto-html/popper.min.js"></script>
<script src="Entrega3_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Entrega3_files/libs/quarto-html/anchor.min.js"></script>
<link href="Entrega3_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Entrega3_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Entrega3_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Entrega3_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Entrega3_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Entrega3</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Ángel García, Arnau Piferrer y Guillem Serra </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<!-- Aixo per fer es beamer https://bookdown.org/yihui/rmarkdown/beamer-presentation.html -->
<!-- data set original https://archive.ics.uci.edu/dataset/45/heart+disease -->
<p>Este es el <a href="https://github.com/GSMir/Entrega3">repositorio</a> de GitHub en el que alojaremos todos los archivos relacionados con esta entrega. Para consultar la fuente de la que se ha extraído nuestro Dataset consulta el siguiente <a href="https://archive.ics.uci.edu/dataset/45/heart+disease">link</a>.</p>
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'MVA' was built under R version 4.3.1</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'HSAUR2' was built under R version 4.3.1</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'corrplot' was built under R version 4.3.1</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'GGally' was built under R version 4.3.1</code></pre>
</div>
</div>
<p>Antes de empezar con el análisis multivariante se realizará una primera limpieza del Dataset. En primer lugar, renombramos las variables para hacerlas más acordes a aquello que representan (en el archivo inicial estaban nombradas como <span class="math inline">\(X_1\)</span>, <span class="math inline">\(X_2\)</span>, <span class="math inline">\(...\)</span>, <span class="math inline">\(X_{14}\)</span>). A continuación, pasamos a factor las variables categóricas (hemos encontrado que muchas no venían dadas como factor incialmente). Por último, dado que tenemos un número pequeño de muestras a las que les falta algún dato (concretamente 6), las hemos eliminado. Recalcar que los datos ausentes venían dados por interrogantes en lugar de NA’s.</p>
<div class="cell">

</div>
<div class="cell">

</div>
<p>El objetivo del estudio original tenía como principal objetivo comparar dos modelos estadísticos (uno antiguo y otro novedoso) que proporcioban estimaciones de la probabilidad de enfermedad coronaria en pacientes que presentaban dolencias en el pecho. Se tomaron las medidas que se detallan en el Dataset a un total de 303 pacientes de Cleveland (Ohio) y se aplicaron otros tres grupos de Hungría, California y Suiza. Nuestro objetivo en esta entrega será determinar los rasgos más significativo del Dataset, así como las relaciones que puedan resultar de mayor interés desde el punto de vista clínico.</p>
<p>En este conjunto de datos encontramos 297 visualizaciones de 14 variables. Se describen a continuación las variables del mismo:</p>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="SinusRhythmLabels.svg.png" class="img-fluid figure-img" style="width:60.0%"></p>
<p></p><figcaption class="figure-caption">Electrocardiograma</figcaption><p></p>
</figure>
</div>
</div>
</div>
<ul>
<li><p><strong>age</strong>: Edad del paciente. Número entero. El conjunto de edades de los sujetos obersvados está comprendido entre los 29 y los 77 años. La media de edad de los pacientes está en los 54.54 años.</p></li>
<li><p><strong>sex</strong>: Sexo cromosómico del paciente. Variable categórica que toma el valor 0 para el sexo femenino y 1 para el masculino. Encontramos un total de 96 mujeres y 201 hombres.</p></li>
<li><p><strong>cp</strong>: (del inglés <em>“Chest Pain”</em>). Hace referencia al tipo de dolor que se sufre el paciente en el pecho. Se trata de una variable categórica que toma los valores 1 para angina de pecho típica, 2 para angina de pecho atípica, 3 para dolores que no son de angina de pecho y 4 para asintomático.</p></li>
<li><p><strong>restbp</strong>: Presión sanguínea medida en reposo (mm Hg). Es una variable numérica con valor mínimo 94 y valor máximo 200. La presión media del grupo de pacientes es de 131.69 mm Hg.</p></li>
<li><p><strong>chol</strong>: Nivel de colesterol en sangre (mg/dl). Variable numérica con mínimo de 126 mg/dl y máximo de 564 mg/dl, siendo el nivel medio de colesterol 247.35 mg/dl.</p></li>
<li><p><strong>fbs</strong>: Booleano que determina si la cantidad de azúcar en sangre en ayuno es mayor a 120mg/dl. Toma el valor 0 para negarlo, y 1 para afirmarlo.</p></li>
<li><p><strong>restecg</strong>: Resultados del electrocardiograma en reposo. Se trata de una variable categórica. Los resultados normales vienen dados por 0, con un 1 se indican aquellos pacientes con anomalías en el segmento ST-T (que pueden ser inversiones de las ondas T y/o elevaciones o depresiones de las ondas ST superiores a 0.05mV). Finalmente, aquellos pacientes con un 2 se caracterizan por tener una alta probabilidad (o segura) una hipertrofia ventricular.</p></li>
<li><p><strong>maxHR</strong>: Indica el ritmo cardíaco máximo alcanzado en una prueba de esfuerzo. Es una variable numérica con valor mínimo de 71, y valor máximo de 202. El valor medio de esta variable es 149.60.</p></li>
<li><p><strong>exang</strong>: Booleano que indica si la angina se ha inducido por el ejercicio, tomando 1 cuando la respuesta sea afirmativa y 0 en caso contrario.</p></li>
<li><p><strong>expeak</strong>: Indica la depresión en el segmento ST inducida por el ejercicio en relación con el reposo. Es una variable numérica con valor mínimo de 0 y valor máximo de 6.20.</p></li>
<li><p><strong>slope</strong>: Indica la pendiente en la cima del segmento ST de ejercicio. Es una variable de tipo factor que toma el valor 0 cuando la pendiente es positiva, 1 cuando la pendiente es nula y 2 cuando la pendiente es negativa.</p></li>
<li><p><strong>mves</strong>: Número de vasos principales coloreados por fluoroscopía. Toma valores enteros entre 0 y 3, inclusive.</p></li>
<li><p><strong>tHR</strong>: Variable categórica que indica el tipo de ritmo cardíaco. Toma el valor 3 para el ritmo normal, 6 para defecto reparado, y 7 para defecto reversible.</p></li>
<li><p><strong>fdiag</strong>: Booleano para el diagnosis de la enfermedad del corazón. Se comenta en la fuente que toma los valores enteros comprendidos entre 0 y 4 (ambos incluidos). No se especifica si se trata del número exacto de patologías diagnosticadas a cada paciente, pero sí que se menciona que el valor 0 se asigna únicamente a aquellos pacientes a los que no se les ha diagnosticado ninguna enfermedad y el resto de valores se atribuyen a los que sí tienen (o han tenido) alguna patología cardíaca. Nosotros la hemos transformado en una variable de tipo factor (0 = “libre enfermedad” y 1 = “diagnosticado”).</p></li>
</ul>
<!-- Toma el 0 cuando la reducción del diámetro es menor al 50%, y 1 cuando es superior al 50%. -->
<section id="análisis-exploratorio-del-conjunto-de-datos" class="level1">
<h1>Análisis exploratorio del conjunto de datos:</h1>
<section id="distribución-de-los-datos-numéricos" class="level2">
<h2 class="anchored" data-anchor-id="distribución-de-los-datos-numéricos">1) Distribución de los datos numéricos:</h2>
<p>Mostramos en primer lugar la distribución de las variables numéricas (que son edad, presión arterial, nivel de colesterol y frecuencia cardiaca máxima) para ver cómo están repartidas en nuestro conjunto de datos (si de forma uniforme o no uniforme).</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="Entrega3_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="frecuencias-de-los-datos-categóricos" class="level2">
<h2 class="anchored" data-anchor-id="frecuencias-de-los-datos-categóricos">2) Frecuencias de los datos categóricos:</h2>
<div class="cell">
<div class="cell-output-display">
<p><img src="Entrega3_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="cruce-del-nivel-de-colesterol-únicamente-según-el-sexo" class="level2">
<h2 class="anchored" data-anchor-id="cruce-del-nivel-de-colesterol-únicamente-según-el-sexo">3) Cruce del nivel de colesterol únicamente según el sexo:</h2>
<p>Observamos que el nivel de colesterol de las mujeres del grupo estudiado es más variado (disperso) que el de los hombres. Esto se aprecia en la amplitud de la caja del diagrama y, se confirma con el <em>outlier</em> que supera los 550mg/dl.</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="Entrega3_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="niveles-de-colesterol-según-edad-y-sexos-de-los-pacientes." class="level2">
<h2 class="anchored" data-anchor-id="niveles-de-colesterol-según-edad-y-sexos-de-los-pacientes.">4) Niveles de colesterol según edad y sexos de los pacientes.</h2>
<p>Nos parece relevante adquirir una información más desglosada sobre la dispersión de los niveles de colesterol según la edad y sexo del paciente. Para ello, hemos optado por clasificar por grupos de edad y repetir el mismo gráfico de antes. En esta nueva versión podemos observar una tendencia creciente en los niveles de colesterol de las mujeres hasta los 69 años, así como un mayor grado de dispersión. En los hombres también se observa esta tendencia al alza, aunque más atenuada.</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="Entrega3_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Se puede observar que, sin tener en cuenta la última franja de edad, a medida que crece la edad, también crece la dispersion. Una de las posibles razones de porque no se cumple esto en la última franja, se puede deber a la pequeña muestra que tenemos de ella.</p>
</section>
<section id="se-replican-los-gráficos-anteriores-pero-para-el-nivel-de-presión-sanguínea." class="level2">
<h2 class="anchored" data-anchor-id="se-replican-los-gráficos-anteriores-pero-para-el-nivel-de-presión-sanguínea.">5) Se replican los gráficos anteriores pero para el nivel de presión sanguínea.</h2>
<div class="cell">
<div class="cell-output-display">
<p><img src="Entrega3_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>No se puede observar diferencias entre hombres y mujeres referente al nivel de presión arterial en reposo. 4)</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="Entrega3_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>En cambio si se puede observar que a medida que va aumentando la edad, tambien crece la dispersión del nivel de presión arterial en reposo. Se puede destacar que todos los puntos outliers estan en la misma franja de edad.</p>
<p>Matrices de dispersión:</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="Entrega3_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<p><img src="Entrega3_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<ol start="5" type="1">
<li>Nube de puntos: con esto podríamos ver si hay (a priori, luego podemos hacer el contraste de correlación oportuno) correlación/covarianza entre las variables maxHR y Colesterol. (La idea sería que las personas con mayor nivel de colesterol suelen estar menos en forma y por ello sus pulsaciones podrían dispararse al hacer ejercicio).</li>
</ol>
<div class="cell">
<div class="cell-output-display">
<p><img src="Entrega3_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<ol start="7" type="1">
<li></li>
</ol>
<div class="cell">
<div class="cell-output-display">
<p><img src="Entrega3_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Distribución del nivel de colesterol según el tipo de dolor en el pecho:</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="Entrega3_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<p><img src="Entrega3_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Análisis inferencial:</p>
<p>Matriz de correlaciones:</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="Entrega3_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Vector de medias de las variables cuantitativas:</p>
<div class="cell">

</div>
<p>Contrastes de correlación:</p>
<ol type="1">
<li>Contraste Edad, Máx Heart Rate:</li>
</ol>
<p>Confirmamos que en la <em>población</em> grande (no en nuestra muestra) la edad y el número máximo de pulsaciones tienen correlación negativa. Esto significa que, a mayor edad se espera que disminuya el número máximo de pulsaciones por minuto.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's product-moment correlation

data:  heartdisease$maxHR and heartdisease$age
t = -7.3752, df = 295, p-value = 8.351e-13
alternative hypothesis: true correlation is less than 0
95 percent confidence interval:
 -1.0000000 -0.3106485
sample estimates:
       cor 
-0.3945629 </code></pre>
</div>
</div>
<ol start="2" type="1">
<li>Contraste de correlación expeak () vs maxHR:</li>
</ol>
<p>Confirmamos que en la <em>población</em> grande (no en nuestra muestra) el número máximo de pulsaciones y el expeak tienen correlación negativa. Esto significa que, a mayor edad, la depresión en el segmento ST inducida por el ejercicio en relación con el reposo es menor.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's product-moment correlation

data:  heartdisease$maxHR and heartdisease$expeak
t = -6.3681, df = 295, p-value = 3.66e-10
alternative hypothesis: true correlation is less than 0
95 percent confidence interval:
 -1.0000000 -0.2606699
sample estimates:
     cor 
-0.34764 </code></pre>
</div>
</div>
<ol start="3" type="1">
<li>Contraste de correlación Edad vs mves():</li>
</ol>
<p>Confirmamos que en la <em>población</em> grande (no en nuestra muestra) la edad y la variable mves(), tienen correlación negativa. Esto significa que, a mayor edad, el número de vasos principales coloreados por fluoroscopía es menor.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's product-moment correlation

data:  heartdisease$age and heartdisease$mves
t = 6.6744, df = 295, p-value = 1
alternative hypothesis: true correlation is less than 0
95 percent confidence interval:
 -1.0000000  0.4425179
sample estimates:
      cor 
0.3622103 </code></pre>
</div>
</div>
<p>Gráfico para datos bivariantes:</p>
<p>El boxplot bivariante es un gráfico de dispersión que incluye dos elipses estimadas, la interior que contiene aproximadamente el 50% de los datos y la exterior que contiene aproximadamente el 95% de los datos. Este tipo de gráficos nos ayuda a localizar datos atípicos. Veamos un ejemplo con los datos de los pingüinos.</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="Entrega3_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<p><img src="Entrega3_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Caras de Chernoff:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>      age        sex     cp          restbp           chol       fbs    
 Min.   :29.00   0: 96   1: 23   Min.   : 94.0   Min.   :126.0   0:254  
 1st Qu.:48.00   1:201   2: 49   1st Qu.:120.0   1st Qu.:211.0   1: 43  
 Median :56.00           3: 83   Median :130.0   Median :243.0          
 Mean   :54.54           4:142   Mean   :131.7   Mean   :247.4          
 3rd Qu.:61.00                   3rd Qu.:140.0   3rd Qu.:276.0          
 Max.   :77.00                   Max.   :200.0   Max.   :564.0          
 restecg     maxHR       exang       expeak      slope        mves       
 0:147   Min.   : 71.0   0:200   Min.   :0.000   1:139   Min.   :0.0000  
 1:  4   1st Qu.:133.0   1: 97   1st Qu.:0.000   2:137   1st Qu.:0.0000  
 2:146   Median :153.0           Median :0.800   3: 21   Median :0.0000  
         Mean   :149.6           Mean   :1.056           Mean   :0.6768  
         3rd Qu.:166.0           3rd Qu.:1.600           3rd Qu.:1.0000  
         Max.   :202.0           Max.   :6.200           Max.   :3.0000  
 tHR     fdiag       decade   
 3:164   0:160   [29,39): 10  
 6: 18   1:137   [39,49): 70  
 7:115           [49,59):112  
                 [59,69): 92  
                 [69,79): 13  
                              </code></pre>
</div>
</div>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>